var agent=(()=>{var d=Object.defineProperty;var u=Object.getOwnPropertySymbols;var h=Object.prototype.hasOwnProperty,w=Object.prototype.propertyIsEnumerable;var v=(t,e,n)=>e in t?d(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,y=(t,e)=>{for(var n in e||(e={}))h.call(e,n)&&v(t,n,e[n]);if(u)for(var n of u(e))w.call(e,n)&&v(t,n,e[n]);return t};var N=t=>d(t,"__esModule",{value:!0});var D=(t,e)=>{N(t);for(var n in e)d(t,n,{get:e[n],enumerable:!0})};var I={};D(I,{default:()=>F});var s;(function(n){n.SET_EVENT="SET_EVENT",n.DELETE_EVENT="DELETE_EVENT"})(s||(s={}));var m=30;function l(t){return e=>new Date(e.date).getFullYear().toString()===t}function T(t,e){return n=>{let r=new Date(n.date);return l(t)(n)&&r.getMonth().toString()===e}}function S(t,e,n){return r=>{let i=new Date(r.date);return T(t,e)(r)&&i.getDate().toString()===n}}var _={aggregations:{events:{initialize:t=>t!=null?t:{},reducer:(t,e)=>{switch(e.data.type){case s.SET_EVENT:t[e.data.event.id]=e.data.event;break;case s.DELETE_EVENT:delete t[e.data.eventId];break}return y({},t)},serialize:t=>t}},views:{eventsForDate:async(t,e)=>{let{year:n,month:r,day:i}=t,a=await e.getAggregation("events",{range:"continuous"});return Object.values(a).filter(S(n,r,i))},eventsForMonth:async(t,e)=>{let{year:n,month:r}=t,i=await e.getAggregation("events",{range:"continuous"});return Object.values(i).filter(T(n,r))},eventsForYear:async(t,e)=>{let{year:n}=t,r=await e.getAggregation("events",{range:"continuous"});return Object.values(r).filter(l(n))}},actions:{setEvent:async(t,e)=>{let{title:n,description:r,date:i,duration:a,id:o}=t,c=new Date(i),g=o!=null?o:await e.createResource(),E={title:n,description:r,date:c,duration:a,id:g};await e.pushEvent(s.SET_EVENT,{event:E},{resourceId:g});let f=new Date(c.getTime()-m*60*1e3);return e.scheduleAction("notify",E,f,{jobKey:`reminder_${g}`}),E},deleteEvent:async(t,e)=>(await e.pushEvent(s.DELETE_EVENT,{eventId:t.eventId}),e.unscheduleAction(`reminder_${t.eventId}`),t.eventId),notify:async(t,e)=>(log(`UPCOMING EVENT: ${JSON.stringify(t)}`),"notified")}},F=_;return I;})();
